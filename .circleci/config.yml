version: 2.1

orbs:
  node: circleci/node@7

workflows:
  ci:
    jobs:
      - node/run:
          name: lint
          pkg-manager: pnpm
          pnpm-run: lint
      - node/test:
          name: test-node-18
          pkg-manager: pnpm
          setup: true
          executor:
            name: node/default
            tag: '18.20'
          post_install_steps:
            - run: pnpm build
          test-results-for: jest
      - node/test:
          name: test-node-20
          pkg-manager: pnpm
          setup: true
          executor:
            name: node/default
            tag: '20.11'
          post_install_steps:
            - run: pnpm build
          test-results-for: jest
